Perfecto, gracias por compartir la imagen. Entiendo que tienes tu archivo Excel conectado a Power BI desde una ruta local (aunque est√© sincronizada con OneDrive), y ahora quieres cambiar esa conexi√≥n para que el archivo sea tomado directamente desde SharePoint, sin perder tus pasos de transformaci√≥n en Power Query. Esto se puede hacer y aqu√≠ te explico paso a paso c√≥mo hacerlo correctamente.

‚∏ª

‚úÖ Objetivo

Cambiar la l√≠nea de conexi√≥n de:

Excel.Workbook(File.Contents("C:\Users\...\Valorizaciones de Riesgos_Live.xlsx"), null, false)

a una que lea directamente desde SharePoint, usando una URL del tipo:

https://[tu_organizaci√≥n].sharepoint.com/sites/[sitio]/[carpeta]/Valorizaciones%20de%20Riesgos_Live.xlsx


‚∏ª

üõ†Ô∏è Pasos detallados

1. Consigue la URL correcta del archivo en SharePoint
	1.	Ve a SharePoint y ubica el archivo Excel.
	2.	Haz clic en ‚ÄúCopiar v√≠nculo‚Äù.
	3.	Aseg√∫rate de obtener una URL directa como esta:

https://[dominio].sharepoint.com/:x:/r/sites/[sitio]/Documentos compartidos/Valorizaciones de Riesgos_Live.xlsx


	4.	Reemplaza lo necesario: lo que realmente usaremos es algo as√≠:

https://[dominio].sharepoint.com/sites/[sitio]/_layouts/15/download.aspx?SourceUrl=/sites/[sitio]/Documentos compartidos/Valorizaciones de Riesgos_Live.xlsx



2. Edita en Power Query el origen (sin perder pasos)
	1.	En Power BI ve a Transformar datos (Power Query).
	2.	En el panel de la izquierda selecciona tu tabla (Riesgos).
	3.	Haz clic en el paso ‚ÄúOrigen‚Äù.
	4.	Reemplaza este c√≥digo:

Excel.Workbook(File.Contents("C:\Users\E305878\OneDrive - Ecopetrol S.A\Carpetas compartidas GIR\BI Riesgos\Data_bwise\RGCI - Valoraciones de Riesgos_Live.xlsx"), null, false)

Por esto otro:

let
    Source = SharePoint.Files("https://[dominio].sharepoint.com/sites/[sitio]", [ApiVersion = 15]),
    File = Source{[Name="Valorizaciones de Riesgos_Live.xlsx"]}[Content],
    Excel = Excel.Workbook(File, null, true)
in
    Excel

üîÅ Reemplaza [dominio] y [sitio] con los valores reales de tu organizaci√≥n.

3. Selecciona la hoja o tabla

Una vez cargues Excel, contin√∫a seleccionando como antes la hoja o tabla llamada Riesgos.

4. Verifica que los dem√°s pasos sigan funcionando

Power Query autom√°ticamente usar√° los pasos posteriores como estaban (filtrados, transformaciones, columnas renombradas, etc.).

‚∏ª

‚úÖ Ejemplo completo (ajustado)

let
    Source = SharePoint.Files("https://ecopetrol.sharepoint.com/sites/GestionRiesgos", [ApiVersion = 15]),
    File = Source{[Name="Valorizaciones de Riesgos_Live.xlsx"]}[Content],
    Excel = Excel.Workbook(File, null, true),
    Riesgos_Sheet = Excel{[Item="Riesgos", Kind="Sheet"]}[Data]
in
    Riesgos_Sheet


‚∏ª

üß† Cosas importantes a tener en cuenta:
	‚Ä¢	No uses Web.Contents() para archivos en SharePoint, porque no lista todos los archivos ni es tan estable como SharePoint.Files().
	‚Ä¢	Si tienes muchas carpetas en el sitio, puedes usar un Table.SelectRows para filtrar el archivo si hay duplicados:

File = Table.SelectRows(Source, each [Name] = "Valorizaciones de Riesgos_Live.xlsx"){0}[Content],


	‚Ä¢	Esto solo funcionar√° si tienes acceso al sitio de SharePoint desde Power BI (tu sesi√≥n debe estar autenticada).

‚∏ª

¬øQuieres que te ayude a convertir exactamente tu l√≠nea original a una basada en SharePoint con tu ruta espec√≠fica? Si me puedes compartir la URL real (o una versi√≥n anonimizada), te genero el c√≥digo exacto.
